# Проект: API с кастомной реализацией пользователей и ролевой системой

Этот проект представляет собой API с кастомной реализацией пользователей и назначения им прав в рамках тестового задания.
## струкртура управления Доступами  Общий концепт
Проект включает стандартные эндпоинты для регистрации, входа, выхода и удаления (мягкое: пользователь не удаляется, а становится неактивным). Реализована ролевая система с тремя базовыми ролями: `ADMIN`, `MODERATOR`, `USER` (можно добавить дополнительные роли).

Схема управления доступами заключается в том, чтобы через 
апи запрос назначать права ролям и через миксин проверять доступы в модели если вкратце

Кратко о правах доступа в приложении для пользователей.

### Роль USER может:
- Регистрация, вход, выход.
- Обновить свой профиль.
- Просмотреть свой профиль и профили других пользователей.
- Удалить свой профиль.

### Роль MODERATOR может:
- Регистрация, вход, выход.
- Обновить свой профиль.
- Удалить свой профиль и профили других пользователей.
- Просмотреть свой профиль и профили других пользователей.

### Роль ADMIN может:
- Регистрация, вход, выход.
- Обновить свой профиль и профили других пользователей.
- Удалить свой профиль и профили других пользователей.
- Просмотреть свой профиль и профили других пользователей.
- Управление ролями: убирать/назначать роли.

Также реализован эндпоинт для назначения кастомных ролей: `admin/manage_roles/`. Логика приложения: админ назначает разрешения для моделей с миксином.
Создан класс `CustomPermissionMixin`, который отвечает за проверку доступов у модели.

Админ отправляет запрос формата:
```json
{
  "role": "USER",
  "perms": {
    "can_view": true,
    "can_edit": false,
    "can_delete": false,
    "can_view_all": true,
    "can_edit_all": false,
    "can_delete_all": false
  }
}
```

Главный плюс такого подхода: можно легко настраивать доступ на любые модели и встраивать его. 
Минусы: если у модели нет поля владельца, миксин будет работать плохо, так как нельзя идентифицировать, 
чья это модель. В будущем постараюсь исправить в таком случае можно использовать обычные миксины и пермишены.




# настройка и запуск

1. Клонируйте репозиторий:

   ```bash
   git clone https://github.com/anor32/Auth-backend
   cd Auth-backend
   ```

 2. Создайте и активируйте виртуальное окружение:

 ```bash
  python -m venv venv

   venv\Scripts\activate   
```

3. Установите зависимости:

   ```bash
   pip install -r requirements.txt
   ```

4. Создайте файл `.env` на основе `.env_sample` и заполните необходимые переменные окружения.



5. Создайте базу данных и выполните миграции:

    ```bash
    python manage.py ccdb
    python manage.py makemigrations
   python manage.py migrate
    ```

6. Создайте пользователей и роли с помощью кастомной команды:

   ```bash
   python manage.py create_users
   ```

фикстур нет так как проект не особо большой и в целом все ок и без них 